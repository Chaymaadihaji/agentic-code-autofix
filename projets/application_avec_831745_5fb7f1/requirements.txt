from flask import Flask, render_template, request, redirect, url_for
from flask_wtf import FlaskForm
from wtforms import StringField, SubmitField
from wtforms.validators import DataRequired
from flask_bootstrap import Bootstrap
from dotenv import load_dotenv
import pandas as pd

load_dotenv()

app = Flask(__name__)
app.config['SECRET_KEY'] = 'secret_key'
Bootstrap(app)

class Formulaire(FlaskForm):
    nom = StringField('Nom', validators=[DataRequired()])
    soumission = SubmitField('Soumettre')

@app.route('/', methods=['GET', 'POST'])
def index():
    form = Formulaire()
    if form.validate_on_submit():
        nom = form.nom.data
        return redirect(url_for('tableau', nom=nom))
    return render_template('index.html', form=form)

@app.route('/tableau/<nom>')
def tableau(nom):
    try:
        df = pd.DataFrame({
            'Caractères Unicode': ['°', '±'],
            'Noms de variables avec accents': [f'{nom} avec accent', f'{nom} sans accent']
        })
        return render_template('tableau.html', df=df)
    except Exception as e:
        return f"Erreur : {str(e)}"

if __name__ == '__main__':
    app.run(debug=True)
