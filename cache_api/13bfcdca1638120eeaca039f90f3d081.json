{"nom_fichier": "main.py", "code": "# main.py\n\nimport os\nfrom flask import Flask, render_template, request, jsonify\nfrom werkzeug.utils import secure_filename\nimport json\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\napp = Flask(__name__)\n\n# Chemin pour les fichiers de données\nUPLOAD_FOLDER = os.path.join(os.getcwd(), 'data')\n\n# Initialisation des données\ndata = [\n    {'id': 1, 'nom': 'Tâche 1', 'état': 'En cours', 'durée': 10},\n    {'id': 2, 'nom': 'Tâche 2', 'état': 'Terminé', 'durée': 20},\n    {'id': 3, 'nom': 'Tâche 3', 'état': 'En cours', 'durée': 30},\n]\n\n# Initialisation des statistiques\nstats = {\n    'total': len(data),\n    'en_cours': sum(1 for t in data if t['état'] == 'En cours'),\n    'terminé': sum(1 for t in data if t['état'] == 'Terminé'),\n}\n\n# Route pour la page d'accueil\n@app.route('/')\ndef index():\n    return render_template('index.html', data=data, stats=stats)\n\n# Route pour récupérer les données en temps réel\n@app.route('/data', methods=['GET'])\ndef get_data():\n    return jsonify(data)\n\n# Route pour ajouter une nouvelle tâche\n@app.route('/ajouter', methods=['POST'])\ndef ajouter_tache():\n    nouveau = {\n        'id': len(data) + 1,\n        'nom': request.form['nom'],\n        'état': 'En cours',\n        'durée': int(request.form['durée']),\n    }\n    data.append(nouveau)\n    stats['total'] += 1\n    stats['en_cours'] += 1\n    return jsonify({'message': 'Tâche ajoutée avec succès'})\n\n# Route pour supprimer une tâche\n@app.route('/supprimer/<int:id>', methods=['GET'])\ndef supprimer_tache(id):\n    for i, t in enumerate(data):\n        if t['id'] == id:\n            del data[i]\n            stats['total'] -= 1\n            if t['état'] == 'En cours':\n                stats['en_cours'] -= 1\n            else:\n                stats['terminé'] -= 1\n            return jsonify({'message': 'Tâche supprimée avec succès'})\n    return jsonify({'message': 'Tâche non trouvée'}), 404\n\n# Route pour mettre à jour l'état d'une tâche\n@app.route('/miser_a_jour/<int:id>', methods=['POST'])\ndef mettre_a_jour_tache(id):\n    for t in data:\n        if t['id'] == id:\n            t['état'] = request.form['état']\n            if t['état'] == 'Terminé':\n                stats['terminé'] += 1\n                stats['en_cours'] -= 1\n            return jsonify({'message': 'État mis à jour avec succès'})\n    return jsonify({'message': 'Tâche non trouvée'}), 404\n\n# Route pour afficher les statistiques\n@app.route('/stats', methods=['GET'])\ndef afficher_stats():\n    return jsonify(stats)\n\n# Route pour afficher un graphique\n@app.route('/graphique', methods=['GET'])\ndef afficher_graphique():\n    df = pd.DataFrame(data)\n    sns.set()\n    plt.figure(figsize=(10, 6))\n    sns.barplot(x='état', y='durée', data=df)\n    plt.title('Durée par état')\n    plt.xlabel('État')\n    plt.ylabel('Durée')\n    plt.show()\n    return 'Graphique affiché'\n\n# Lancement de l'application\nif __name__ == \"__main__\":\n    app.run(debug=True)\n", "timestamp": 1766330845.365569}