{"nom_fichier": "src/index.tsx", "code": "typescript\n// src/index.tsx\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter, Route, Switch } from 'react-router-dom';\nimport { Provider } from 'react-redux';\nimport { store, persistor } from './store/configureStore';\nimport { PersistGate } from 'redux-persist/integration/react';\n\nimport App from './components/App';\nimport Login from './components/Login';\nimport Register from './components/Register';\nimport Dashboard from './components/Dashboard';\nimport Project from './components/Project';\nimport FileUpload from './components/FileUpload';\nimport Notifications from './components/Notifications';\n\nimport './styles/index.css';\n\nconst token = localStorage.getItem('token');\n\nconst AuthenticatedRoute = ({ children }: { children: JSX.Element }) => {\n  if (token) {\n    return children;\n  } else {\n    return <Login />;\n  }\n};\n\nconst UnauthenticatedRoute = ({ children }: { children: JSX.Element }) => {\n  if (!token) {\n    return children;\n  } else {\n    return <Dashboard />;\n  }\n};\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <PersistGate persistor={persistor}>\n        <BrowserRouter>\n          <Switch>\n            <Route path=\"/\" component={AuthenticatedRoute}>\n              <Route path=\"/project/:id\" component={Project} />\n              <Route path=\"/file-upload\" component={FileUpload} />\n              <Route path=\"/notifications\" component={Notifications} />\n            </Route>\n            <Route path=\"/login\" component={Login} />\n            <Route path=\"/register\" component={Register} />\n          </Switch>\n        </BrowserRouter>\n      </PersistGate>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// API ROUTES\n\nimport express from 'express';\nimport { json } from 'body-parser';\nimport { authenticate } from './middleware/authenticate';\nimport { projectRouter } from './routes/project';\nimport { fileRouter } from './routes/file';\nimport { notificationRouter } from './routes/notification';\n\nconst app = express();\napp.use(json());\napp.use(authenticate);\napp.use('/project', projectRouter);\napp.use('/file', fileRouter);\napp.use('/notification', notificationRouter);\napp.use(express.static('public'));\n\nconst port = process.env.PORT || 3000;\napp.listen(port, () => {\n  console.log(`Server started on port ${port}`);\n});\n\n// SOCKET.IO\n\nimport { Server } from 'socket.io';\nimport { io } from './utils/socket';\n\nconst server = new Server({ cors: { origin: '*' } });\n\nserver.on('connection', (socket) => {\n  console.log('Client connected');\n\n  socket.on('disconnect', () => {\n    console.log('Client disconnected');\n  });\n\n  socket.on('notification', (notification) => {\n    console.log(`Received notification: ${notification}`);\n  });\n});\n\nserver.listen(3001, () => {\n  console.log('Socket.IO server started on port 3001');\n});\n", "timestamp": 1767000955.833686}