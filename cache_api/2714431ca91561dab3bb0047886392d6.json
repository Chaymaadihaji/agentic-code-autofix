{"nom_fichier": "models.py", "code": "python\n# models.py\nfrom sqlite3 import Error\nimport os\nfrom typing import List\nfrom dataclasses import dataclass\n\n@dataclass\nclass Task:\n    \"\"\"Répresentation d'une tâche\"\"\"\n    id: int\n    title: str\n    completed: bool\n\nclass Database:\n    \"\"\"Système de gestion de base de données SQLite\"\"\"\n    def __init__(self, db_name: str):\n        self.conn = None\n        self.db_name = db_name\n\n    def connect(self):\n        \"\"\"Se connecter à la base de données SQLite\"\"\"\n        try:\n            self.conn = sqlite3.connect(self.db_name)\n            return self.conn\n        except Error as e:\n            print(e)\n            return None\n\n    def create_table(self):\n        \"\"\"Créer la table des tâches\"\"\"\n        query = \"\"\"\n            CREATE TABLE IF NOT EXISTS tasks (\n                id INTEGER PRIMARY KEY,\n                title TEXT NOT NULL,\n                completed BOOLEAN DEFAULT 0\n            )\n        \"\"\"\n        try:\n            self.conn.execute(query)\n        except Error as e:\n            print(e)\n\n    def save_task(self, task: Task):\n        \"\"\"Enregistrer une tâche\"\"\"\n        query = \"INSERT INTO tasks (id, title, completed) VALUES (?, ?, ?)\"\n        try:\n            self.conn.execute(query, (task.id, task.title, task.completed))\n            self.conn.commit()\n        except Error as e:\n            print(e)\n\n    def get_tasks(self) -> List[Task]:\n        \"\"\"Récupérer toutes les tâches\"\"\"\n        query = \"SELECT * FROM tasks\"\n        try:\n            cursor = self.conn.cursor()\n            cursor.execute(query)\n            rows = cursor.fetchall()\n            return [Task(row[0], row[1], row[2]) for row in rows]\n        except Error as e:\n            print(e)\n            return []\n\n\n# app.py\nfrom flask import Flask, render_template, request, redirect, url_for\nfrom models import Database, Task\n\napp = Flask(__name__)\n\ndef get_db():\n    \"\"\"Se connecter à la base de données\"\"\"\n    db_name = \"tasks.db\"\n    db = Database(db_name)\n    db.connect()\n    db.create_table()\n    return db\n\n@app.route(\"/\")\ndef index():\n    \"\"\"Voir la liste des tâches\"\"\"\n    db = get_db()\n    tasks = db.get_tasks()\n    return render_template(\"index.html\", tasks=tasks)\n\n@app.route(\"/add\", methods=[\"GET\", \"POST\"])\ndef add():\n    \"\"\"Ajouter une nouvelle tâche\"\"\"\n    if request.method == \"POST\":\n        task = Task(1, request.form[\"title\"], 0)\n        db = get_db()\n        db.save_task(task)\n        return redirect(url_for(\"index\"))\n    return render_template(\"add.html\")\n\nif __name__ == \"__main__\":\n    app.run(debug=True)\n\n\n# templates/index.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>liste de tâches</title>\n  </head>\n  <body>\n    <h1>liste des tâches</h1>\n    <ul>\n      {% for task in tasks %}\n        <li>{{ task.title }}\n          {% if task.completed %}\n            <span class=\"text-decoration-throught\">COMPLÉTÉ</span>\n  print('Erreur tentative 3'  # Guillemet manquant (bug)\n          {% else %}\n            <span>À faire</span>\n          {% endif %}\n        </li>\n      {% endfor %}\n    </ul>\n  </body>\n</html>\n\n# templates/add.html\n<!DOCTYPE html>\n<html>\n  <head>\n    <title>Ajouter une tâche</title>\n  </head>\n  <body>\n    <h1>Ajouter une tâche</h1>\n    <form method=\"POST\">\n      <input type=\"text\" name=\"title\" placeholder=\"Titre de la tâche\">\n      <button type=\"submit\">Ajouter</button>\n    </form>\n  </body>\n</html>\n\n# requirements.txt\nflask==2.0.3\nsqlite3==3.38.0\n", "langage": "python", "bugs_introduits": ["syntax_error"], "corrections_appliquees": [], "timestamp": 1767108991.1717005, "tentative": 3}