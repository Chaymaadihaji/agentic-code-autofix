{"nom_fichier": "src/index.tsx", "code": "typescript\n// src/index.tsx\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport App from './App';\nimport { Provider } from 'react-redux';\nimport store from './store';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport io from 'socket.io-client';\n\nconst socket = io();\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <BrowserRouter>\n        <App socket={socket} />\n        <ToastContainer />\n      </BrowserRouter>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// server.ts\nimport express, { Request, Response, NextFunction } from 'express';\nimport mongoose from 'mongoose';\nimport cors from 'cors';\nimport morgan from 'morgan';\nimport passport from 'passport';\nimport jwt from 'jsonwebtoken';\nimport userRoutes from './routes/user';\nimport projectRoutes from './routes/project';\nimport fileRoutes from './routes/file';\nimport notificationRoutes from './routes/notification';\n\nconst app = express();\nconst port = process.env.PORT || 3001;\n\napp.use(cors());\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\napp.use(morgan('dev'));\napp.use(passport.initialize());\n\nmongoose.connect(process.env.MONGODB_URI, { useNewUrlParser: true, useUnifiedTopology: true })\n  .then(() => console.log('Connected to MongoDB'))\n  .catch((err) => console.error('Error connecting to MongoDB:', err));\n\napp.use('/users', userRoutes);\napp.use('/projects', projectRoutes);\napp.use('/files', fileRoutes);\napp.use('/notifications', notificationRoutes);\n\napp.get('/auth/token', (req: Request, res: Response) => {\n  const token = req.header('x-auth-token');\n  if (!token) return res.status(401).send({ message: 'No token provided' });\n  try {\n    const decoded = jwt.verify(token, process.env.SECRET_KEY);\n    res.send({ message: 'Token is valid', decoded });\n  } catch (err) {\n    res.status(400).send({ message: 'Invalid token' });\n  }\n});\n\napp.listen(port, () => {\n  console.log(`Server listening on port ${port}`);\n});\n\n// types.ts\ndeclare module 'express' {\n  interface Request {\n    user?: any;\n  }\n}\n\n// user.ts\nimport mongoose, { Document, Schema } from 'mongoose';\nimport bcrypt from 'bcryptjs';\nimport jwt from 'jsonwebtoken';\n\ninterface IUser {\n  name: string;\n  email: string;\n  password: string;\n}\n\ninterface IUserDocument extends IUser, Document {}\n\nconst userSchema = new Schema<IUserDocument>({\n  name: { type: String, required: true },\n  email: { type: String, required: true, unique: true },\n  password: { type: String, required: true },\n});\n\nuserSchema.pre('save', async function(next) {\n  if (!this.isModified('password')) return next();\n  const salt = await bcrypt.genSalt(10);\n  this.password = await bcrypt.hash(this.password, salt);\n  next();\n});\n\nuserSchema.methods.generateAuthToken = function() {\n  const token = jwt.sign({ _id: this._id }, process.env.SECRET_KEY);\n  return token;\n};\n\nconst User = mongoose.model<IUserDocument>('User', userSchema);\nexport default User;\n\n// project.ts\nimport mongoose, { Document, Schema } from 'mongoose';\n\ninterface IProject {\n  title: string;\n  description: string;\n  user: string;\n}\n\ninterface IProjectDocument extends IProject, Document {}\n\nconst projectSchema = new Schema<IProjectDocument>({\n  title: { type: String, required: true },\n  description: { type: String, required: true },\n  user: { type: Schema.Types.ObjectId, ref: 'User' },\n});\n\nconst Project = mongoose.model<IProjectDocument>('Project', projectSchema);\nexport default Project;\n\n// file.ts\nimport mongoose, { Document, Schema } from 'mongoose';\n\ninterface IFile {\n  name: string;\n  type: string;\n  projectId: string;\n}\n\ninterface IFileDocument extends IFile, Document {}\n\nconst fileSchema = new Schema<IFileDocument>({\n  name: { type: String, required: true },\n  type: { type: String, required: true },\n  projectId: { type: Schema.Types.ObjectId, ref: 'Project' },\n});\n\nconst File = mongoose.model<IFileDocument>('File', fileSchema);\nexport default File;\n\n// notification.ts\nimport mongoose, { Document, Schema } from 'mongoose';\n\ninterface INotification {\n  message: string;\n  projectId: string;\n}\n\ninterface INotificationDocument extends INotification, Document {}\n\nconst notificationSchema = new Schema<INotificationDocument>({\n  message: { type: String, required: true },\n  projectId: { type: Schema.Types.ObjectId, ref: 'Project' },\n});\n\nconst Notification = mongoose.model<INotificationDocument>('Notification', notificationSchema);\nexport default Notification;\n\n// socket.ts\nimport io from 'socket.io-client';\n\nconst socket = io();\n\nexport default socket;\n\n// store.ts\nimport { createStore, applyMiddleware } from 'redux';\nimport { composeWithDevTools } from 'redux-devtools-extension';\nimport thunk from 'redux-thunk';\nimport rootReducer from './reducers';\n\nconst initialState = {};\n\nconst middleware = [thunk];\n\nconst store = createStore(rootReducer, initialState, composeWithDevTools(applyMiddleware(...middleware)));\n\nexport default store;\n\n// reducers.ts\nimport { combineReducers } from 'redux';\nimport userReducer from './userReducer';\nimport projectReducer from './projectReducer';\nimport fileReducer from './fileReducer';\nimport notificationReducer from './notificationReducer';\n\nconst rootReducer = combineReducers({\n  user: userReducer,\n  project: projectReducer,\n  file: fileReducer,\n  notification: notificationReducer,\n});\n\nexport default rootReducer;\n\n// userReducer.ts\nimport { reducer as formReducer } from 'redux-form';\n\nconst initialState = {};\n\nconst userReducer = (state = initialState, action) => {\n  switch (action.type) {\n    default:\n      return state;\n  }\n};\n\nexport default userReducer;\n\n// projectReducer.ts\nimport { reducer as formReducer } from 'redux-form';\n\nconst initialState = {};\n\nconst projectReducer = (state = initialState, action) => {\n  switch (action.type) {\n    default:\n      return state;\n  }\n};\n\nexport default projectReducer;\n\n// fileReducer.ts\nimport { reducer as formReducer } from 'redux-form';\n\nconst initialState = {};\n\nconst fileReducer = (state = initialState, action) => {\n  switch (action.type) {\n    default:\n      return state;\n  }\n};\n\nexport default fileReducer;\n\n// notificationReducer.ts\nimport { reducer as formReducer } from 'redux-form';\n\nconst initialState = {};\n\nconst notificationReducer = (state = initialState, action) => {\n  switch (action.type) {\n    default:\n      return state;\n  }\n};\n\nexport default notificationReducer;\n", "timestamp": 1767001003.049715}