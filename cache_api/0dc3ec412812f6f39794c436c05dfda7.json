{"nom_fichier": "models.py", "code": "# models.py\n\nfrom flask_sqlalchemy import SQLAlchemy\nfrom flask_jwt_extended import JWTManager\nfrom flask_restful import Resource, Api\nfrom flask import Flask\nimport json\nfrom datetime import datetime, timedelta\n\napp = Flask(__name__)\napp.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///bibliotheque.db'\ndb = SQLAlchemy(app)\njwt = JWTManager(app)\napi = Api(app)\n\nclass Livre(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    titre = db.Column(db.String(100), nullable=False)\n    auteur = db.Column(db.String(100), nullable=False)\n\nclass Membre(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    nom = db.Column(db.String(100), nullable=False)\n    prenom = db.Column(db.String(100), nullable=False)\n    email = db.Column(db.String(100), nullable=False, unique=True)\n\nclass Emprunt(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    livre_id = db.Column(db.Integer, db.ForeignKey('livre.id'), nullable=False)\n    membre_id = db.Column(db.Integer, db.ForeignKey('membre.id'), nullable=False)\n    date_emprunt = db.Column(db.DateTime, nullable=False)\n    date_retour = db.Column(db.DateTime, nullable=False)\n\nclass ApiLivre(Resource):\n    def get(self):\n        livres = Livre.query.all()\n        return [{'id': livre.id, 'titre': livre.titre, 'auteur': livre.auteur} for livre in livres]\n\nclass ApiMembre(Resource):\n    def get(self):\n        membres = Membre.query.all()\n        return [{'id': membre.id, 'nom': membre.nom, 'prenom': membre.prenom, 'email': membre.email} for membre in membres]\n\nclass ApiEmprunt(Resource):\n    def get(self):\n        emprunts = Emprunt.query.all()\n        return [{'id': emprunt.id, 'livre_id': emprunt.livre_id, 'membre_id': emprunt.membre_id, 'date_emprunt': emprunt.date_emprunt, 'date_retour': emprunt.date_retour} for emprunt in emprunts]\n\nclass ApiAuth(Resource):\n    def post(self):\n        data = request.get_json()\n        if data['email'] == 'admin' and data['password'] == 'admin':\n            access_token = jwt.create_access_token(identity=data['email'])\n            return {'access_token': access_token}\n        return {'error': 'Invalid credentials'}, 401\n\napi.add_resource(ApiLivre, '/livres')\napi.add_resource(ApiMembre, '/membres')\napi.add_resource(ApiEmprunt, '/emprunts')\napi.add_resource(ApiAuth, '/auth')\n\n@app.route('/')\ndef index():\n    return 'Bienvenue dans la biblioth√®que !'\n\nif __name__ == \"__main__\":\n    app.run(debug=True)\n", "timestamp": 1766864147.677221}