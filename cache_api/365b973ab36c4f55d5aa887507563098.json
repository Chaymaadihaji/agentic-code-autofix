{"nom_fichier": "data_processor.py", "code": "# data_processor.py\n\nimport json\nfrom flask import Flask, jsonify, request\nfrom flask_sqlalchemy import SQLAlchemy\nfrom werkzeug.security import generate_password_hash\nfrom datetime import datetime\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\n\napp = Flask(__name__)\napp.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///database.db'\ndb = SQLAlchemy(app)\n\n# Fiches patients détaillées\nclass Patient(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    nom = db.Column(db.String(100), nullable=False)\n    prenom = db.Column(db.String(100), nullable=False)\n    date_naissance = db.Column(db.DateTime, nullable=False)\n\n# Historique médical\nclass Historique(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    patient_id = db.Column(db.Integer, db.ForeignKey('patient.id'), nullable=False)\n    date = db.Column(db.DateTime, nullable=False)\n    description = db.Column(db.Text, nullable=False)\n\n# Ordonnances numériques\nclass Ordonnance(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    patient_id = db.Column(db.Integer, db.ForeignKey('patient.id'), nullable=False)\n    date = db.Column(db.DateTime, nullable=False)\n    medicament = db.Column(db.String(100), nullable=False)\n    dose = db.Column(db.String(100), nullable=False)\n\n# Prise de rendez-vous\nclass RendezVous(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    patient_id = db.Column(db.Integer, db.ForeignKey('patient.id'), nullable=False)\n    date = db.Column(db.DateTime, nullable=False)\n    heure = db.Column(db.Time, nullable=False)\n\n# Alertes médicaments\nclass Alerte(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    patient_id = db.Column(db.Integer, db.ForeignKey('patient.id'), nullable=False)\n    date = db.Column(db.DateTime, nullable=False)\n    description = db.Column(db.Text, nullable=False)\n\n# Dossier médical partagé\nclass Dossier(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    patient_id = db.Column(db.Integer, db.ForeignKey('patient.id'), nullable=False)\n    fichier = db.Column(db.LargeBinary, nullable=False)\n\n# Graphiques de suivi santé\ndef graphiques_patient(patient_id):\n    patient = Patient.query.get(patient_id)\n    historiques = Historique.query.filter_by(patient_id=patient_id).all()\n    ordonnances = Ordonnance.query.filter_by(patient_id=patient_id).all()\n    rendez_vous = RendezVous.query.filter_by(patient_id=patient_id).all()\n    alertes = Alerte.query.filter_by(patient_id=patient_id).all()\n\n    plt.figure(figsize=(10, 6))\n    sns.set_style('whitegrid')\n    sns.lineplot(x=[h.date for h in historiques], y=[h.description for h in historiques])\n    plt.title('Historique médical')\n    plt.xlabel('Date')\n    plt.ylabel('Description')\n    plt.show()\n\n    plt.figure(figsize=(10, 6))\n    sns.set_style('whitegrid')\n    sns.scatterplot(x=[o.date for o in ordonnances], y=[o.dose for o in ordonnances])\n    plt.title('Ordonnances numériques')\n    plt.xlabel('Date')\n    plt.ylabel('Dose')\n    plt.show()\n\n    plt.figure(figsize=(10, 6))\n    sns.set_style('whitegrid')\n    sns.barplot(x=[r.date for r in rendez_vous], y=[r.heure for r in rendez_vous])\n    plt.title('Rendez-vous')\n    plt.xlabel('Date')\n    plt.ylabel('Heure')\n    plt.show()\n\n    plt.figure(figsize=(10, 6))\n    sns.set_style('whitegrid')\n    sns.barplot(x=[a.date for a in alertes], y=[a.description for a in alertes])\n    plt.title('Alertes médicaments')\n    plt.xlabel('Date')\n    plt.ylabel('Description')\n    plt.show()\n\n# Rapports pour médecins\ndef rapport_medicin(patient_id):\n    patient = Patient.query.get(patient_id)\n    historiques = Historique.query.filter_by(patient_id=patient_id).all()\n    ordonnances = Ordonnance.query.filter_by(patient_id=patient_id).all()\n    rendez_vous = RendezVous.query.filter_by(patient_id=patient_id).all()\n    alertes = Alerte.query.filter_by(patient_id=patient_id).all()\n\n    rapport = {\n        'patient': patient.nom + ' ' + patient.prenom,\n        'historique': [h.description for h in historiques],\n        'ordonnances': [o.medicament for o in ordonnances],\n        'rendez-vous': [r.heure for r in rendez_vous],\n        'alertes': [a.description for a in alertes]\n    }\n\n    return rapport\n\n# Chiffrement des données\ndef chiffrement_donnees(data):\n    return generate_password_hash(data)\n\n# API pour les données en temps réel\n@app.route('/donnees', methods=['GET'])\ndef donnees():\n    patient_id = request.args.get('patient_id')\n    data = Patient.query.get(patient_id)\n    return jsonify({'data': data})\n\n# Structure modulaire pour différentes visualisations\n@app.route('/graphiques', methods=['GET'])\ndef graphiques():\n    patient_id = request.args.get('patient_id')\n    graphiques_patient(patient_id)\n    return jsonify({'message': 'Graphiques générés'})\n\n# Route pour la création d'un patient\n@app.route('/patients', methods=['POST'])\ndef create_patient():\n    data = request.get_json()\n    patient = Patient(nom=data['nom'], prenom=data['prenom'], date_naissance=data['date_naissance'])\n    db.session.add(patient)\n    db.session.commit()\n    return jsonify({'message': 'Patient créé'})\n\n# Route pour la création d'un rendez-vous\n@app.route('/rendez-vous', methods=['POST'])\ndef create_rendez_vous():\n    data = request.get_json()\n    rendez_vous = RendezVous(patient_id=data['patient_id'], date=data['date'], heure=data['heure'])\n    db.session.add(rendez_vous)\n    db.session.commit()\n    return jsonify({'message': 'Rendez-vous créé'})\n\n# Route pour la création d'une ordonnance\n@app.route('/ordonnances', methods=['POST'])\ndef create_ordonnance():\n    data = request.get_json()\n    ordonnance = Ordonnance(patient_id=data['patient_id'], date=data['date'], medicament=data['medicament'], dose=data['dose'])\n    db.session.add(ordonnance)\n    db.session.commit()\n    return jsonify({'message': 'Ordonnance créée'})\n\n# Route pour la création d'une alerte\n@app.route('/alertes', methods=['POST'])\ndef create_alerte():\n    data = request.get_json()\n    alerte = Alerte(patient_id=data['patient_id'], date=data['date'], description=data['description'])\n    db.session.add(alerte)\n    db.session.commit()\n    return jsonify({'message': 'Alerte créée'})\n\n# Route pour la création d'un dossier médical\n@app.route('/dossiers', methods=['POST'])\ndef create_dossier():\n    data = request.get_json()\n    dossier = Dossier(patient_id=data['patient_id'], fichier=data['fichier'])\n    db.session.add(dossier)\n    db.session.commit()\n    return jsonify({'message': 'Dossier médical créé'})\n\nif __name__ == \"__main__\":\n    db.create_all()\n    app.run(debug=True)\n", "timestamp": 1766765560.4931962}