{"nom_fichier": "README.md", "code": "# app.py\nfrom flask import Flask, render_template, request, redirect, url_for\nfrom flask_sqlalchemy import SQLAlchemy\nfrom flask_bcrypt import Bcrypt\nimport flask_smg\nimport smtplib\nfrom email.message import EmailMessage\nfrom flask_bootstrap import Bootstrap\n\napp = Flask(__name__)\napp.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///database.db'\napp.config['SECRET_KEY'] = 'secret_key'\ndb = SQLAlchemy(app)\nbcrypt = Bcrypt(app)\nbootstrap = Bootstrap(app)\n\n# Modèle de l'utilisateur\nclass Utilisateur(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    email = db.Column(db.String(120), unique=True, nullable=False)\n    mot_de_passe = db.Column(db.String(120), nullable=False)\n\n# Modèle de la connexion\nclass Connexion(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    utilisateur_id = db.Column(db.Integer, db.ForeignKey('utilisateur.id'), nullable=False)\n    date = db.Column(db.DateTime, nullable=False, default=db.func.current_timestamp())\n\n# Route de connexion\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    if request.method == 'POST':\n        email = request.form['email']\n        mot_de_passe = request.form['mot_de_passe']\n        utilisateur = Utilisateur.query.filter_by(email=email).first()\n        if utilisateur and bcrypt.check_password_hash(utilisateur.mot_de_passe, mot_de_passe):\n            return redirect(url_for('accueil'))\n    return render_template('login.html')\n\n# Route d'inscription\n@app.route('/register', methods=['GET', 'POST'])\ndef register():\n    if request.method == 'POST':\n        email = request.form['email']\n        mot_de_passe = request.form['mot_de_passe']\n        utilisateur = Utilisateur(email=email, mot_de_passe=bcrypt.generate_password_hash(mot_de_passe).decode('utf-8'))\n        db.session.add(utilisateur)\n        db.session.commit()\n        return redirect(url_for('accueil'))\n    return render_template('register.html')\n\n# Route de réinitialisation du mot de passe\n@app.route('/reset-password', methods=['GET', 'POST'])\ndef reset_password():\n    if request.method == 'POST':\n        email = request.form['email']\n        mot_de_passe = request.form['mot_de_passe']\n        utilisateur = Utilisateur.query.filter_by(email=email).first()\n        if utilisateur:\n            utilisateur.mot_de_passe = bcrypt.generate_password_hash(mot_de_passe).decode('utf-8')\n            db.session.commit()\n            return redirect(url_for('accueil'))\n    return render_template('reset_password.html')\n\n# Route de l'historique des connexions\n@app.route('/history')\ndef history():\n    connexions = Connexion.query.all()\n    return render_template('history.html', connexions=connexions)\n\nif __name__ == '__main__':\n    app.run(debug=True)\n", "timestamp": 1766865404.6010158}