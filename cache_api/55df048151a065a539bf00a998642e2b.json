{"nom_fichier": "routes.py", "code": "from flask import Flask, render_template, request, jsonify\nfrom flask_sqlalchemy import SQLAlchemy\nimport json\nfrom datetime import datetime\n\napp = Flask(__name__)\napp.config[\"SQLALCHEMY_DATABASE_URI\"] = \"sqlite:///database.db\"\ndb = SQLAlchemy(app)\n\nclass Task(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    title = db.Column(db.String(100), nullable=False)\n    completed = db.Column(db.Boolean, default=False)\n    created_at = db.Column(db.DateTime, default=datetime.utcnow)\n\nclass Dashboard:\n    def __init__(self):\n        self.tasks = []\n\n    def add_task(self, title):\n        task = Task(title=title)\n        db.session.add(task)\n        db.session.commit()\n        self.tasks.append(task)\n\n    def get_tasks(self):\n        return Task.query.all()\n\n    def get_statistics(self):\n        completed_tasks = Task.query.filter_by(completed=True).count()\n        total_tasks = Task.query.count()\n        return {\n            \"completed\": completed_tasks,\n            \"total\": total_tasks,\n            \"progress\": completed_tasks / total_tasks * 100 if total_tasks > 0 else 0\n        }\n\n    def filter_tasks(self, status):\n        return Task.query.filter_by(completed=status).all()\n\n    def get_filtered_stats(self, status):\n        tasks = self.filter_tasks(status)\n        return {\n            \"completed\": len(tasks),\n            \"total\": len(tasks),\n            \"progress\": 100 if status else 0\n        }\n\ndashboard = Dashboard()\n\n@app.route(\"/\")\ndef index():\n    tasks = dashboard.get_tasks()\n    stats = dashboard.get_statistics()\n    return render_template(\"index.html\", tasks=tasks, stats=stats)\n\n@app.route(\"/add-task\", methods=[\"POST\"])\ndef add_task():\n    title = request.json[\"title\"]\n    dashboard.add_task(title)\n    return jsonify({\"message\": \"Task added successfully\"})\n\n@app.route(\"/filter-tasks\", methods=[\"POST\"])\ndef filter_tasks():\n    status = request.json[\"status\"]\n    tasks = dashboard.filter_tasks(status)\n    stats = dashboard.get_filtered_stats(status)\n    return jsonify({\"tasks\": [task.title for task in tasks], \"stats\": stats})\n\n@app.route(\"/stats\")\ndef get_stats():\n    stats = dashboard.get_statistics()\n    return jsonify(stats)\n\nif __name__ == \"__main__\":\n    app.run(debug=True)\n", "timestamp": 1766328121.963699}