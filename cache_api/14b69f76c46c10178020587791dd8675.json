{"nom_fichier": "app.py", "code": "import os\nfrom flask import Flask, render_template, request, jsonify\nimport json\nfrom datetime import datetime\nimport random\nfrom statistics import mean\n\napp = Flask(__name__)\n\n# Génération de données pour le dashboard\ndonnees = [\n    {\"nom\": \"Tâche 1\", \"début\": \"2022-01-01\", \"fin\": \"2022-01-05\", \"état\": \"en cours\"},\n    {\"nom\": \"Tâche 2\", \"début\": \"2022-02-01\", \"fin\": \"2022-02-10\", \"état\": \"terminée\"},\n    {\"nom\": \"Tâche 3\", \"début\": \"2022-03-01\", \"fin\": \"2022-03-20\", \"état\": \"en cours\"},\n    {\"nom\": \"Tâche 4\", \"début\": \"2022-04-01\", \"fin\": \"2022-04-15\", \"état\": \"terminée\"},\n    {\"nom\": \"Tâche 5\", \"début\": \"2022-05-01\", \"fin\": \"2022-05-25\", \"état\": \"en cours\"}\n]\n\n# Calcul des statistiques/métriques\ndef calcul_statistiques(donnees):\n    temps_total = 0\n    nb_taches_en_cours = 0\n    nb_taches_terminées = 0\n    for tache in donnees:\n        temps_total += (datetime.strptime(tache[\"fin\"], \"%Y-%m-%d\") - datetime.strptime(tache[\"début\"], \"%Y-%m-%d\")).days\n        if tache[\"état\"] == \"en cours\":\n            nb_taches_en_cours += 1\n        elif tache[\"état\"] == \"terminée\":\n            nb_taches_terminées += 1\n    moyenne_temps = temps_total / len(donnees)\n    return moyenne_temps, nb_taches_en_cours, nb_taches_terminées\n\n# API pour les données en temps réel\n@app.route(\"/donnees\", methods=[\"GET\"])\ndef donnees_api():\n    return jsonify(donnees)\n\n# Route pour afficher le dashboard\n@app.route(\"/\")\ndef index():\n    moyenne_temps, nb_taches_en_cours, nb_taches_terminées = calcul_statistiques(donnees)\n    return render_template(\"index.html\", donnees=donnees, moyenne_temps=moyenne_temps, nb_taches_en_cours=nb_taches_en_cours, nb_taches_terminées=nb_taches_terminées)\n\n# Route pour créer une nouvelle tâche\n@app.route(\"/creer_tache\", methods=[\"POST\"])\ndef creer_tache():\n    nom = request.form[\"nom\"]\n    debut = request.form[\"debut\"]\n    fin = request.form[\"fin\"]\n    etat = \"en cours\"\n    donnees.append({\"nom\": nom, \"début\": debut, \"fin\": fin, \"état\": etat})\n    return jsonify({\"message\": \"Tâche créée avec succès\"})\n\n# Route pour mettre à jour un tâche\n@app.route(\"/mettre_a_jour_tache\", methods=[\"POST\"])\ndef mettre_a_jour_tache():\n    id_tache = request.form[\"id\"]\n    nom = request.form[\"nom\"]\n    debut = request.form[\"debut\"]\n    fin = request.form[\"fin\"]\n    etat = request.form[\"etat\"]\n    donnees[int(id_tache)][\"nom\"] = nom\n    donnees[int(id_tache)][\"début\"] = debut\n    donnees[int(id_tache)][\"fin\"] = fin\n    donnees[int(id_tache)][\"état\"] = etat\n    return jsonify({\"message\": \"Tâche mise à jour avec succès\"})\n\n# Route pour supprimer un tâche\n@app.route(\"/supprimer_tache\", methods=[\"POST\"])\ndef supprimer_tache():\n    id_tache = request.form[\"id\"]\n    del donnees[int(id_tache)]\n    return jsonify({\"message\": \"Tâche supprimée avec succès\"})\n\n# Route pour filtrer les tâches\n@app.route(\"/filtrer_taches\", methods=[\"POST\"])\ndef filtrer_taches():\n    etat = request.form[\"etat\"]\n    donnees_filtrees = [tache for tache in donnees if tache[\"état\"] == etat]\n    return jsonify(donnees_filtrees)\n\n# Route pour trier les tâches\n@app.route(\"/trier_taches\", methods=[\"POST\"])\ndef trier_taches():\n    ordre = request.form[\"ordre\"]\n    if ordre == \"asc\":\n        donnees_triees = sorted(donnees, key=lambda x: x[\"nom\"])\n    elif ordre == \"desc\":\n        donnees_triees = sorted(donnees, key=lambda x: x[\"nom\"], reverse=True)\n    return jsonify(donnees_triees)\n\nif __name__ == \"__main__\":\n    app.run(debug=True)\n", "timestamp": 1766328102.7804737}