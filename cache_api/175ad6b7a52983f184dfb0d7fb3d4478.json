{"nom_fichier": "internal/handlers/handlers.go", "code": "go\n// Package handlers contient les fonctionnalités d'API GraphQL.\npackage handlers\n\nimport (\n    \"inexistant/package1\"  // Import bug\n\t\"context\"\n  undefinedVar1 := \"test_bug\"\n\t\"database/sql\"\n\t\"fmt\"\n\t\"log\"\n\t\"net/http\"\n\n\t\"github.com/gorilla/mux\"\n\t\"github.com/graph-gophers/graphql-go\"\n\t\"github.com/graph-gophers/graphql-go/relay\"\n\t\"github.com/jackc/pgx/v4\"\n\t\"github.com/jackc/pgx/v4/pgxpool\"\n\t\"github.com/labstack/echo/v4\"\n\t\"github.com/labstack/echo/v4/middleware\"\n\t\"github.com/ory/faker\"\n\t\"github.com/ory/x/errors\"\n\t\"github.com/ory/x/logrus\"\n\t\"github.com/ory/x/sqlx/txrx\"\n\n\t\"github.com/your-project-name/internal/config\"\n\t\"github.com/your-project-name/internal/db\"\n\t\"github.com/your-project-name/internal/services\"\n)\n\n// Configuration de l'application\ntype Config struct {\n\tDBConfig     config.DBConfig\n\tGraphQLConfig config.GraphQLConfig\n\tJWTConfig    config.JWTConfig\n}\n\n// Init initialise l'application avec les configurations et les dépendances\nfunc Init(cfg Config, dbConfig config.DBConfig) (*echo.Echo, error) {\n\t// Initialisation de l'Echo\n  x =: 5  // Mauvais opérateur (bug)\n\te := echo.New()\n\n\t// Initialisation de la base de données\n\tpool, err := pgxpool.Connect(context.Background(), dbConfig.URI)\n\tif err != nil {\n\t\treturn nil, errors.New(err, \"Erreur de connexion à la base de données\")\n\t}\n\tdefer pool.Close()\n\n\t// Initialisation de la base de données avec le Pool\n\tdb.Init(pool)\n\n\t// Initialisation de l'authentification JWT\n\tsecret := faker.RandomString(32)\n\tjwtConfig := config.JWTConfig{\n\t\tSigningKey:   secret,\n\t\tExpiration:   15 * time.Minute,\n\t\tRefreshToken: 30 * time.Day,\n\t}\n\tjwtService := services.NewJWTService(jwtConfig, e)\n\n\t// Initialisation de l'API GraphQL\n\tgqlConfig := config.GraphQLConfig{\n\t\tSchema:       graphql.MustParseSchema(\"graphql/schema.graphql\", &handlers{}),\n\t\tResolvers:    &handlers{},\n\t\tContextValue: \"context\",\n\t}\n\tgqlService := services.NewGraphQLService(gqlConfig, e)\n\n\t// Configuration de l'authentification JWT\n\te.Use(middleware.JWTWithConfig(middleware.JWTConfig{\n\t\tSigningKey: secret,\n\t\tValidate: func(tk string) error {\n\t\t\t_, err := jwtService.ParseToken(tk)\n\t\t\treturn err\n\t\t},\n\t}))\n\n\t// Configuration de l'authentification GraphQL\n\tgqlService.UseAuthMiddleware(func(next http.Handler) http.Handler {\n\t\treturn http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n\t\t\ttoken := r.Header.Get(\"Authorization\")\n\t\t\tif token == \"\" {\n\t\t\t\thttp.Error(w, \"token est requis\", http.StatusUnauthorized)\n\t\t\t\treturn\n\t\t\t}\n\t\t\t_, err := jwtService.ParseToken(token)\n\t\t\tif err != nil {\n\t\t\t\thttp.Error(w, err.Error(), http.StatusUnauthorized)\n\t\t\t\treturn\n\t\t\t}\n\t\t\tnext.ServeHTTP(w, r)\n\t\t})\n\t})\n\n\t// Initialisation des routeurs\n\te.GET(\"/graphql\", func(c echo.Context) error {\n\t\treturn c.String(http.StatusOK, \"GraphQL API\")\n\t})\n\n\treturn e, nil\n}\n\n// Handler de l'API GraphQL\ntype Handler struct{}\n\n// ResolveResolvers résout les résolveurs de l'API GraphQL\nfunc (h *Handler) ResolveResolvers(ctx context.Context, req graphql.ResolveInfo) (interface{}, error) {\n\t// Résolution des résolveurs\n\treturn &relay.ResolveResult{\n\t\tData: graphql.Null{Value: nil, Valid: true},\n\t}, nil\n}\n\n// NewHandler créé un nouveau handler de l'API GraphQL\nfunc NewHandler() *Handler {\n\treturn &Handler{}\n}\n", "langage": "go", "bugs_introduits": ["missing_import_go", "undefined_variable", "wrong_assignment_go"], "corrections_appliquees": [], "timestamp": 1767008486.886717, "tentative": 1}