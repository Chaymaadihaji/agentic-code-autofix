{"nom_fichier": "cmd/api/main.go", "code": "go\n// Package main est l'application d'API GraphQL\npackage main\n\nimport (\n\t\"context\"\n\t\"database/sql\"\n\t\"fmt\"\n\t\"log\"\n\t\"net/http\"\n\t_ \"github.com/lib/pq\"\n\t\"github.com/graphql-go/graphql\"\n\t\"github.com/graphql-go/handler\"\n)\n\n// Database connection string\nconst dbConnectionString string = \"user=username password=password host=localhost port=5432 dbname=mydatabase sslmode=disable\"\n\n// Type de données pour l'utilisateur\ntype UserType struct {\n\tID       uint    `json:\"id\"`\n\tEmail    string  `json:\"email\"`\n\tPassword string  `json:\"password\"`\n}\n\n// Resolver du type utilisateur\nvar UserTypeResolver func(ctx context.Context) (*UserType, error)\n\n// UserResolver fonction de résolution pour l'utilisateur\nfunc UserResolver(p *graphql.ResolveParams) (interface{}, error) {\n\treturn UserTypeResolver(p.Context)\n}\n\n// Schema de GraphQL\nvar schema, _ = graphql.NewSchema(graphql.SchemaConfig{\n\tType: graphql.NewObject(graphql.ObjectConfig{\n\t\tName: \"Query\",\n\t\tFields: graphql.Fields{\n\t\t\t\"user\": &graphql.Field{\n\t\t\t\tType: graphql.NewObject(graphql.ObjectConfig{\n\t\t\t\t\tName: \"User\",\n\t\t\t\t\tFields: graphql.Fields{\n\t\t\t\t\t\t\"id\": &graphql.Field{\n\t\t\t\t\t\t\tType: graphql.ID,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"email\": &graphql.Field{\n\t\t\t\t\t\t\tType: graphql.String,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"password\": &graphql.Field{\n\t\t\t\t\t\t\tType: graphql.String,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tResolve: UserResolver,\n\t\t\t},\n\t\t},\n\t}),\n\tResolvers: map[string]func(context.Context) interface{}{\n\t\t\"user\": UserResolver,\n\t},\n})\n\nfunc main() {\n\t// Gestion d'erreur pour la database connection\n\tvar err error\n\tdb, err := sql.Open(\"postgres\", dbConnectionString)\n\tif err != nil {\n\t\tlog.Fatal(err)\n\t}\n\tdefer db.Close()\n\n\t// Créer une nouvelle instance de GraphQL handler et spécifiez le schéma\n\th := handler.New(&handler.Config{\n\t\tSchema:        &schema,\n\t\tPretty:        true, // Pretty-print the output\n\t\tGraphiQL:      true,\n\t})\n\n\t// Enregistre le route graphiql\n\thttp.HandleFunc(\"/graphiql\", func(w http.ResponseWriter, r *http.Request) {\n\t\thttp.Redirect(w, r, \"/graphiql?path=/query\", 302)\n\t})\n\n\t// Route principale pour l'endpoint GraphQL\n\thttp.Handle(\"/graphql\", h)\n\n\tfmt.Println(\":8000\")\n\tlog.Fatal(http.Serve(http.DefaultServeMux, \"localhost:8000\"))\n}\n", "langage": "go", "bugs_introduits": [], "corrections_appliquees": [], "timestamp": 1767009048.1313794, "tentative": 4}