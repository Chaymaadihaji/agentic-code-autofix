{"nom_fichier": "app.py", "code": "from flask import Flask, render_template, request\nfrom flask_sqlalchemy import SQLAlchemy\nimport json\nimport random\nfrom datetime import datetime, timedelta\n\napp = Flask(__name__)\napp.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///data.db'\ndb = SQLAlchemy(app)\n\nclass Task(db.Model):\n    id = db.Column(db.Integer, primary_key=True)\n    title = db.Column(db.String(100), nullable=False)\n    description = db.Column(db.String(200), nullable=False)\n    completed = db.Column(db.Boolean, default=False)\n    deadline = db.Column(db.DateTime, nullable=False)\n    priority = db.Column(db.Integer, nullable=False)\n\n@app.route('/')\ndef index():\n    tasks = Task.query.all()\n    return render_template('index.html', tasks=tasks)\n\n@app.route('/create', methods=['POST'])\ndef create_task():\n    title = request.form['title']\n    description = request.form['description']\n    deadline = datetime.strptime(request.form['deadline'], '%Y-%m-%d')\n    priority = int(request.form['priority'])\n    task = Task(title=title, description=description, deadline=deadline, priority=priority)\n    db.session.add(task)\n    db.session.commit()\n    return 'Task created'\n\n@app.route('/update', methods=['POST'])\ndef update_task():\n    task_id = int(request.form['id'])\n    task = Task.query.get(task_id)\n    task.completed = not task.completed\n    db.session.commit()\n    return 'Task updated'\n\n@app.route('/delete', methods=['POST'])\ndef delete_task():\n    task_id = int(request.form['id'])\n    task = Task.query.get(task_id)\n    db.session.delete(task)\n    db.session.commit()\n    return 'Task deleted'\n\n@app.route('/stats')\ndef stats():\n    tasks = Task.query.all()\n    completed = len([t for t in tasks if t.completed])\n    total = len(tasks)\n    graph_data = {'labels': ['Completed', 'Incomplete'], 'datasets': [{'data': [completed, total - completed]}]}\n    return render_template('stats.html', graph_data=graph_data)\n\n@app.route('/filter', methods=['POST'])\ndef filter_tasks():\n    filter_type = request.form['filter_type']\n    filter_value = request.form['filter_value']\n    if filter_type == 'priority':\n        tasks = Task.query.filter_by(priority=filter_value).all()\n    elif filter_type == 'deadline':\n        deadline = datetime.strptime(filter_value, '%Y-%m-%d')\n        tasks = Task.query.filter_by(deadline=deadline).all()\n    return render_template('index.html', tasks=tasks)\n\n@app.route('/tri', methods=['POST'])\ndef tri_tasks():\n    tri_type = request.form['tri_type']\n    if tri_type == 'title':\n        tasks = Task.query.order_by(Task.title).all()\n    elif tri_type == 'deadline':\n        tasks = Task.query.order_by(Task.deadline).all()\n    return render_template('index.html', tasks=tasks)\n\nif __name__ == \"__main__\":\n    with open('data.json', 'w') as f:\n        json.dump([{'title': 'Task 1', 'description': 'Description 1', 'deadline': '2024-03-16', 'priority': 1, 'completed': False}, \n                   {'title': 'Task 2', 'description': 'Description 2', 'deadline': '2024-03-17', 'priority': 2, 'completed': True}], f)\n    db.create_all()\n    app.run(debug=True)\n", "timestamp": 1766329946.7178442}