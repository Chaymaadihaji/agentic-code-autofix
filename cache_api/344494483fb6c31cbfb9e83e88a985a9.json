{"nom_fichier": "go.mod", "code": "golang\npackage main\n\nimport (\n\t\"context\"\n\t\"log\"\n\t\"net/http\"\n\n\t\"github.com/graphql-go/graphql\"\n\t\"github.com/graphql-go/handler\"\n\t\"github.com/graphql-go/graphql/gqlerrors\"\n\t\"github.com/graphql-go/relay\"\n\t\"github.com/vektah/gqlparser/v2/ast\"\n\t\"github.com/99designs/gqlgen/graphql/introspection\"\n\t\"github.com/joho/godotenv\"\n\t\"log\"\n\n\t\"github.com/graphql-go/graphql-go/v2/graphql\"\n\t\"github.com/graphql-go/graphql-go/v2/gqlerrors\"\n)\n\nfunc main() {\n\tloadEnvVars()\n\tctx := context.Background()\n\n\t// GraphQL Schema\n\tschema := buildSchema()\n\n\t// GraphQL Schema Introspection\n\tis := &graphql.SchemaIntrospection{\n\t\tSchema: schema,\n\t}\n\n\t// GraphQL Schema Relay\n\trelaySchema := relay.NewSchema(schema, relay.DefaultOptions()...)\n\n\t// New GraphQL Handler\n\th := handler.New(&handler.Config{\n\t\tSchema:                 &graphql.Schema{Schema: schema},\n\t\tPretty:                 true,\n\t\tPlayground:             true,\n\t\tGRPCPath:               \"/graphql\",\n\t\tDisableIntrospection:   true,\n\t})\n\n\t// JWT Auth Middleware\n\tjwtMiddleware := jwtMiddleware()\n\n\t// API Routes\n\tmux := http.NewServeMux()\n\tmux.HandleFunc(\"/login\", loginHandler)\n\tmux.HandleFunc(\"/graphql\", jwtMiddleware(h.ServeHTTP))\n\n\t// Logger\n\tlog.Println(\"API Started on port 8080\")\n\tlog.Fatal(http.ListenAndServe(\":8080\", jwtMiddleware(http.DefaultServeMux)))\n}\n\nfunc buildSchema() *graphql.Schema {\n\t// Type Definitions\n\ttodo := graphql.NewObject(&graphql.ObjectConfig{\n\t\tName: \"Todo\",\n\t\tFields: graphql.Fields{\n\t\t\t\"id\": &graphql.Field{\n\t\t\t\tType: graphql.ID,\n\t\t\t},\n\t\t\t\"title\": &graphql.Field{\n\t\t\t\tType: graphql.String,\n\t\t\t},\n\t\t\t\"status\": &graphql.Field{\n\t\t\t\tType: graphql.Boolean,\n\t\t\t},\n\t\t},\n\t})\n\n\tquery := graphql.NewObject(&graphql.ObjectConfig{\n\t\tName: \"Query\",\n\t\tFields: graphql.Fields{\n\t\t\t\"todos\": &graphql.Field{\n\t\t\t\tType: graphql.NewList(graphql.NewObject(graphql.ObjectConfig{\n\t\t\t\t\tName: \"Todo\",\n\t\t\t\t\tFields: graphql.Fields{\n\t\t\t\t\t\t\"id\": &graphql.Field{Type: graphql.ID},\n\t\t\t\t\t\t\"title\": &graphql.Field{Type: graphql.String},\n\t\t\t\t\t\t\"status\": &graphql.Field{Type: graphql.Boolean},\n\t\t\t\t\t},\n\t\t\t\t})),\n\t\t\t\tResolve: func(p graphql.ResolveParams) (interface{}, error) {\n\t\t\t\t\tdb, err := setupDatabase()\n\t\t\t\t\tif err != nil {\n\t\t\t\t\t\treturn nil, err\n\t\t\t\t\t}\n\t\t\t\t\treturn getTodos(db), nil\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t})\n\n\tmutation := graphql.NewObject(&graphql.ObjectConfig{\n\t\tName: \"Mutation\",\n\t\tFields: graphql.Fields{\n\t\t\t\"createTodo\": &graphql.Field{\n\t\t\t\tType: graphql.NewObject(graphql.ObjectConfig{\n\t\t\t\t\tName: \"Todo\",\n\t\t\t\t\tFields: graphql.Fields{\n\t\t\t\t\t\t\"id\": &graphql.Field{Type: graphql.ID},\n\t\t\t\t\t\t\"title\": &graphql.Field{Type: graphql.String},\n\t\t\t\t\t\t\"status\": &graphql.Field{Type: graphql.Boolean},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tArgs: graphql.FieldConfigMap{\n\t\t\t\t\t\"title\": &graphql.ArgumentConfig{\n\t\t\t\t\t\tType: graphql.NewNonNull(graphql.String),\n\t\t\t\t\t},\n\t\t\t\t\t\"status\": &graphql.ArgumentConfig{\n\t\t\t\t\t\tType: graphql.Boolean,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tResolve: func(p graphql.ResolveParams) (interface{}, error) {\n\t\t\t\t\tdb, err := setupDatabase()\n\t\t\t\t\tif err != nil {\n\t\t\t\t\t\treturn nil, err\n\t\t\t\t\t}\n\t\t\t\t\treturn createTodo(db, p.Args), nil\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t})\n\n\tschema, err := graphql.NewSchema(\n\t\tgraphql.SchemaConfig{\n\t\t\tQuery:    query,\n\t\t\tMutation: mutation,\n\t\t\tSubscribe: nil,\n\t\t\tResolve:   nil,\n\t\t})\n\tif err != nil {\n\t\tlog.Fatal(err)\n\t}\n\treturn schema\n}\n\nfunc loginHandler(w http.ResponseWriter, r *http.Request) {\n\t// login logic here\n\tw.WriteHeader(http.StatusOK)\n\tw.Write([]byte(\"Logged in Successfully\"))\n}\n", "langage": "gomod", "bugs_introduits": ["syntax_error", "undefined_variable"], "corrections_appliquees": [], "timestamp": 1767008960.7865698, "tentative": 3}