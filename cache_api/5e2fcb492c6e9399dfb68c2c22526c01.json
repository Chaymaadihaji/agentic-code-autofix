{"nom_fichier": "cmd/api/main.go", "code": "go\n// cmd/api/main.go\n\npackage main\n\nimport (\n\t\"context\"\n\t\"fmt\"\n\t\"log\"\n\t\"net/http\"\n\t\"os\"\n\t\"os/signal\"\n\t\"time\"\n\n\t\"github.com/gin-gonic/gin\"\n\t\"github.com/swaggo/gin-swagger\"\n\t\"github.com/swaggo/gin-swagger/swaggerFiles\"\n)\n\ntype Server struct {\n\trouter *gin.Engine\n}\n\nfunc NewServer() *Server {\n\treturn &Server{\n\t\trouter: gin.New(),\n\t}\n}\n\nfunc (s *Server) Run(addr string) {\n\ts.router.GET(\"/swagger/*any\", swaggerFiles.SwaggerUI)\n\n\tv1 := s.router.Group(\"/api/v1\")\n\n\tv1.GET(\"/users\", getUsers)\n\tv1.GET(\"/users/:id\", getUser)\n\n\tv1.POST(\"/users\", createUser)\n\tv1.PUT(\"/users/:id\", updateUser)\n\tv1.DELETE(\"/users/:id\", deleteUser)\n\n\ts.router.Run(addr)\n}\n\nfunc main() {\n\tif v := os.Getenv(\"GIN_MODE\"); v != \"release\" {\n\t\tgin.SetMode(gin.DebugMode)\n\t}\n\n\tsrv := NewServer()\n\n addr := fmt.Sprintf(\":%s\", os.Getenv(\"PORT\"))\n srv.Run(addr)\n\n log.Println(\"Server listening on\", addr)\n\n signalChan := make(chan os.Signal, 1)\n signal.Notify(signalChan, os.Interrupt)\n\n <-signalChan\n log.Println(\"Server shutting down...\")\n\n ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\n defer cancel()\n\n if err := srv.router.Unscoped().Shutdown(ctx); err != nil {\n  log.Fatal(err)\n }\n\n log.Println(\"Server shutdown complete\")\n}\n", "timestamp": 1766868020.8085532}